<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Categories - E-Commerce App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<div id="navbar"></div>

<div class="container mt-4">
  <h2>Category List</h2>
  <table id="categoriesTable" class="table table-bordered mt-3">
    <thead><tr><th>Category</th><th>Total Products</th><th>Status</th></tr></thead>
    <tbody></tbody>
  </table>

  <h4 class="mt-4">Products per Category</h4>
  <button id="updateCategoryChart" class="btn btn-sm btn-success mb-2">Update Chart</button>
  <canvas id="categoryPageChart"></canvas>
</div>

<div id="footer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/footer.js"></script>
<script src="js/navbar.js"></script>
<script src="js/script.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
  populateCategoriesTable();

  if(document.getElementById("categoryPageChart")){
    window.catChart = new Chart(document.getElementById("categoryPageChart").getContext("2d"), {
      type:'pie',
      data:{
        labels: categories.map(c=>c.name),
        datasets:[{ data: getCategoryCounts().map(c=>c.total), backgroundColor:['red','blue','green','orange','purple'] }]
      },
      options:{ responsive:true }
    });

    document.getElementById("updateCategoryChart").addEventListener("click", ()=>{
      catChart.data.datasets[0].data = getCategoryCounts().map(c=>c.total);
      catChart.update();
    });
  }
});
</script>

</body>
</html>
